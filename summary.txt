1. Motivations

Foraging is a fundamental behavior of animals. However, its neural basis are
not well understood. At the Sainsbury Wellcome Centre and Gatsby Computational
Neuroscience Unit, University College London, we are building computational
infrastructure to continuously monitor (24 hours a day, 7 days a week) the
behavioral and neural activity of mice, as they freely forage in a large arena
containing patches delivering food rewards.

Here we describe, and carefully evaluate, computer vision, statistical
inference and learning methods that we used to estimate the position, velocity
and acceleration of mice foraging in this arena. We also provide a Python
toolbox, with sample data, implementing this functionality.

We used functionality in the OpenCV library to extract the position of the
mouse in each video frame.

Positions (x and y coordinates) of a mouse were measured while it
foraged in a circular arena (diameter 2 meters) with two food patches.
Each food patch contained a wheel that the mouse needed to rotate a given
distance (e.g., 1 meter) to obtain a pellet of food reward. Measurements ware
obtained in a well lighted environment with a video camera (Spinnaker Blackfly
S, model BFS-U3-16S2M, 50 Hz) located one meter above the center of the arena.

We first evaluated the accuracy of the proposed tracking methods with simulated
data, for which we knew the true positions, velocities and accelerations. Then
we used real measurements from a foraging mouse.

Simulated true data was generated by sampling positions, velocities and
accelerations from a Discrtete Time Wiener Process Acceleration model
(Bar-Shalom et al., 01). Simulated measured data were true measurments with
added Gaussian White Noise.

We measure the root-means-square error between the true positions, velocities
and accelerations and those estimated by the Kalman filter, Kalman smoother and
a baseline finite differences method. We compared the performance of Kalman
filters and smoothers with manually chosen and learned parameters.

With simulated data we observed that the Kalman filter and smoother provided
more accurate estimates of velocities and accelerations than the baseline
finite differences method and that Kalman filter. We also obtained more
accurate estimates with learned than with manually set parameters.

With real measurements, the estimated velocities and accelerations by the
Kalman filter and smoother, and those from the baseline finite-difference
method, were substantially different, and these differences followed similar
patterns as with simulated data. This suggest that the Kalman filter and
smoother estimates are more accurate than those of the finite difference
method.

An additional advantage of the Kalman filter and smoother is that it allowed
to infer missing measurements, where the mouse was occluded by objects in the
arena.

Real measuements were obtained in a well controlled and well illuminated
environment, and their noise level was low. For these measurements learned
parameters did not yieled subtantial improvements in comparison with manually
chosen ones.

Reproducibility is paramount in science. We provide code and sample data to
reproduce all figures in this poster.

An advantage 
allowed us to estimate missing position values resulting from occlusions of the mouse by objects in the arena. In addition, it 

2. Methods

3. Results

3.1 Simulations

3.2 Foraging mouse

Methods

5. Reproducible science

5. Conclusions

6. Acknowledgments
